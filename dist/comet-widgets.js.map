{"version":3,"file":"comet-widgets.js","sources":["../src/services/rest.ts","../src/services/api.ts","../src/comet-utils.ts","../src/carousel/carousel-template.ts","../src/carousel/carousel.ts"],"sourcesContent":["import $ from 'jquery';\n\nimport { AlbumModel, MediaModel } from \"../models/index\"\nimport Utils from \"../comet-utils\"\n\nexport default class Rest {\n\n  public static get(url: string): Promise<any> {\n    return $.get(url);\n  }\n\n}\n","import Rest from './rest';\n\nimport { AlbumModel, MediaModel } from \"../models/index\"\nimport Utils from \"../comet-utils\"\n\nexport default class ApiService {\n\n  public static API_URL = 'https://api.cometapp.io/v2/';\n\n  public static getAlbum(uuid: string): Promise<AlbumModel> {\n    return Rest.get(`${ApiService.API_URL}albums/${uuid}`)\n      .then(response => response.data as AlbumModel)\n      .catch(ApiService.handleError);\n  }\n\n  public static getAlbumByShortId(shortId: string): Promise<AlbumModel> {\n    return Rest.get(`${ApiService.API_URL}albums/short_id/${shortId}`)\n      .then(response => response.data as AlbumModel)\n      .catch(ApiService.handleError);\n  }\n\n  public static getAlbumMedias(uuid: string, params?: any): Promise<MediaModel[]> {\n    let url = `${ApiService.API_URL}albums/${uuid}/medias`;\n    if (params) {\n      url = `${url}?${$.param(params)}`;\n    }\n    return Rest.get(url)\n      .then(response => response.data as MediaModel[])\n      .catch(ApiService.handleError);\n  }\n\n  protected static handleError(response: any): Promise<any> {\n    let err = JSON.parse(response.responseText);\n    console.error(`(${err.code} ${err.message}) ${err.error.type}: ${err.error.message}`);\n    return Promise.reject({});\n  }\n\n}\n","import $ from 'jquery';\n\n// const $window = $(window);\n\nexport default class Utils {\n\n  public static isUuid(uuid: string): boolean {\n    if (!uuid || uuid.length !== 24 || !uuid.match(/[a-f0-9]/)) {\n      return false;\n    }\n    return true;\n  }\n\n  public static bestMediaFormat(): string {\n    class Format { name: string; size: number; constructor(name: string, size: number) { this.name = name; this.size = size; } }\n    let mediaFormats: Format[] = [\n      new Format('s', 370),\n      new Format('m', 555),\n      new Format('l', 1110),\n      new Format('xl', 1242),\n    ];\n    let w = {\n      width: $(window).width() || 0,\n      height: $(window).height() || 0,\n    };\n    let size = Math.max(w.width, w.height);\n    let format = 'xl';\n    for (let i = 0; i < mediaFormats.length; i++) {\n      if (mediaFormats[i].size > size) {\n        format = mediaFormats[i].name;\n        break\n      }\n    }\n    // for (let i in mediaFormats) {\n    //   if (mediaFormats[i] > size) {\n    //     format = (i as string);\n    //     break\n    //   }\n    // }\n    return format;\n  }\n\n}\n","import $ from 'jquery'\nimport 'bootstrap'\n\nexport default class CarouselTemplate {\n  public static renderWait(options: any) {\n    let carousel: any = {\n      id: options.id,\n      slides: [],\n      tpls: { indicators: '', items: '', controls: '' }\n    }\n    let template = CarouselTemplate.getTemplate('global', { carousel })\n    CarouselTemplate.display(template, options)\n  }\n\n  public static render(slides: string[], options: any) {\n    // Create the carousel object\n    let tpls: any = { indicators: '', items: '', controls: '' }\n    let carousel: any = { id: options.id, slides: slides, tpls: tpls }\n\n    // Render the subtemplates\n    for (let i in carousel.slides) {\n      tpls.indicators =\n        tpls.indicators +\n        CarouselTemplate.getTemplate('indicator', { carousel, i })\n    }\n    for (let i in carousel.slides) {\n      tpls.items =\n        tpls.items + CarouselTemplate.getTemplate('item', { carousel, i })\n    }\n    if (options.controls) {\n      tpls.controls = CarouselTemplate.getTemplate('controls', { carousel });\n    }\n\n    // Render the template & append to body\n    let template = CarouselTemplate.getTemplate('global', { carousel })\n    CarouselTemplate.display(template, options)\n    CarouselTemplate.start(options)\n  }\n\n  // restart a stopped carousel\n  public static restart(options: any) {\n    $(`#${options.id}`)\n      .fadeIn()\n      .carousel('cycle')\n  }\n\n  // stop the carousel\n  public static stop(options: any) {\n    $(`#${options.id}`)\n      .fadeOut()\n      .carousel('pause')\n  }\n\n  // move to a slide\n  public static goTo(nb: number, options: any) {\n    $(`#${options.id}`).carousel(`${nb}`)\n  }\n\n  protected static display(template: string, options: any) {\n\n    let fullscreen = !options.selector || !$(`${options.selector}`).length;\n    let $container = fullscreen ? $('body') : $(`${options.selector}`);\n\n    // If existing, replace\n    if ($(`#${options.id}`).length) {\n      $(`#${options.id}`).replaceWith(template)\n    } else {\n      $container.append(template);\n    }\n\n    let $items = $(`#${options.id} .item`);\n    // if I do that in the template, carousel is not working\n    $items.eq(0).addClass('active')\n    $items.height($container.height() as number).css({\n      // backgroundColor: 'black',\n      backgroundSize: 'contain',\n      backgroundPosition: 'center',\n      backgroundRepeat: 'no-repeat'\n    })\n    // transform the imgs into background-images\n    $(`#${options.id} img`).each(function() {\n      let src = $(this).attr('src')\n      $(this)\n        .parent('.item')\n        .css({ backgroundImage: `url(${src})` })\n      $(this).remove()\n    })\n\n    // Fullscreen options\n    if (fullscreen) {\n\n      // Set height\n      let windowHeight = $(window).height() as number\n      $items.height(windowHeight).css({ backgroundColor: 'black' });\n\n      // on resize\n      $(window).on('resize', () => {\n        let windowHeight = $(window).height() as number\n        $items.height(windowHeight)\n      })\n\n      // Display the template\n      $(`#${options.id}`).css({\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%'\n      })\n    }\n  }\n\n  // start the carousel\n  protected static start(options: any) {\n    $(`#${options.id}`)\n      .hide()\n      .carousel({\n        pause: 'false',\n        interval: options.interval,\n        wrap: options.loop\n      })\n      .fadeIn()\n  }\n\n  protected static getTemplate(template: string, params: any): string {\n    let { carousel, i } = params\n    const global = `\n    <div id=\"${carousel.id}\" class=\"carousel slide\" data-ride=\"carousel\">\n      <!-- Indicators -->\n      <!-- <ol class=\"carousel-indicators\">\n        ${carousel.tpls.indicators}\n      </ol> -->\n\n      <!-- Slides -->\n      <div class=\"carousel-inner\" role=\"listbox\">\n        ${carousel.tpls.items}\n      </div>\n\n      <!-- Controls -->\n      ${carousel.tpls.controls}\n    </div>`\n    const indicator = `\n      <li data-target=\"#${carousel.id}\" data-slide-to=\"${i}\"${i === 0\n      ? ' class=\"active\"'\n      : ''}></li>`\n    const item = `\n      <div class=\"item\"><img src=\"${carousel.slides[i]}\" /></div>`\n    const controls = `\n      <a class=\"left carousel-control\" href=\"#${carousel.id}\" role=\"button\" data-slide=\"prev\">\n        <span class=\"glyphicon glyphicon-chevron-left\" aria-hidden=\"true\"></span>\n        <span class=\"sr-only\">Previous</span>\n      </a>\n      <a class=\"right carousel-control\" href=\"#${carousel.id}\" role=\"button\" data-slide=\"next\">\n        <span class=\"glyphicon glyphicon-chevron-right\" aria-hidden=\"true\"></span>\n        <span class=\"sr-only\">Next</span>\n      </a>`\n\n    switch (template) {\n      case 'global':\n        return global\n      case 'indicator':\n        return indicator\n      case 'item':\n        return item\n      case 'controls':\n        return controls\n      default:\n        return ''\n    }\n  }\n}\n","import $ from 'jquery'\n\nimport ApiService from '../services/api'\nimport { AlbumModel, MediaModel } from '../models/index'\nimport Utils from '../comet-utils'\n\nimport CarouselTemplate from './carousel-template'\n\n/**\n * Carousel component\n */\nexport class Carousel {\n  // state control\n  private load: Promise<boolean>\n  private loaded: boolean // if true, the data is loaded\n  private cycling: boolean // if false, the slider is stopped\n\n  private options: any\n  private album: AlbumModel\n  private medias: MediaModel[]\n  private choosenFormat: string\n\n  constructor(public id: string, userOptions: any = {}) {\n    // Check dependencies\n    if (typeof $ === 'undefined') {\n      console.error('jQuery was not found')\n      return\n    }\n    if (!$.fn.carousel) {\n      console.error('bootstrap was not found')\n      return\n    }\n\n    // Get the data\n    this.load = new Promise<boolean>((resolve, reject) => {\n      if (!id) {\n        reject(false)\n        console.error('An album id is a required parameter')\n        return\n      }\n\n      // Define the options\n      let defaultOptions = {\n        selector: null, // if a selector is specified, the carousel is not fullscreen\n        format: 'o', // Dimensions of the pictures (o, xl, l, m, s)\n        controls: false, // show the controls or not\n        interval: 5000, // duration of every picture\n        loop: true, // will start again when reached the last picture\n        infos: true, // TODO wether to display photo informations, like the user or the date\n        watch: false, // TODO will regularily ask the server for new pictures and auto-update itself\n      }\n      delete userOptions.id\n      this.options = $.extend({}, defaultOptions, userOptions)\n      this.options.id = `comet-gallery-${Math.floor(Math.random() * 1000)}`\n      // if (\n      //   this.options.selector &&\n      //   this.options.selector.match(/^\\#[a-zA-Z0-9\\_\\-]+$/g)\n      // ) {\n      //   this.options.id = this.options.selector.substring(1)\n      // } else {\n      //   this.options.id = `comet-gallery-${Math.floor(Math.random() * 1000)}`\n      // }\n\n      // Find the album & the medias\n      let promise: Promise<AlbumModel>\n      if (Utils.isUuid(id)) {\n        promise = ApiService.getAlbum(id)\n      } else {\n        promise = ApiService.getAlbumByShortId(id)\n      }\n      promise.then(album => {\n        // Set data\n        if (!album.uuid) {\n          reject(false)\n          return\n        }\n        this.album = album\n\n        // Then find the medias\n        // this.choosenFormat = Utils.bestMediaFormat()\n        this.choosenFormat = this.options.format;\n        ApiService.getAlbumMedias(album.uuid, {\n          format: this.choosenFormat\n        }).then(medias => {\n          // Set data\n          if (!medias.length) {\n            reject(false)\n            return\n          }\n          this.medias = medias\n          resolve(true)\n\n          console.info(\n            `%c${medias.length} %cmedias in the album %c${album.title}`,\n            'color:blue',\n            'color:black',\n            'color:blue'\n          )\n        })\n      })\n    })\n  }\n\n  /**\n   * Start to display the carousel\n   */\n  start(firstSlide?: number): Promise<boolean> {\n    if (!this.load) {\n      return Promise.reject(false)\n    }\n\n    // If it's a restart\n    if (this.loaded && !this.cycling) {\n      this.restart(firstSlide)\n      return Promise.resolve(true)\n    }\n\n    // Render the waiting page\n    CarouselTemplate.renderWait(this.options)\n\n    // When the medias are loaded\n    return this.load\n      .then(() => {\n        // If parallel loadiation\n        if (this.loaded) {\n          return Promise.resolve(true)\n        }\n\n        // If problem with data\n        if (!this.album || !this.medias) {\n          console.error('could not start the carousel')\n          return Promise.reject(false)\n        }\n\n        // Set state\n        this.loaded = true\n\n        // Render the carousel\n        let slides: string[] = []\n        for (let i in this.medias) {\n          slides.push(this.medias[i].formats[this.choosenFormat] as string)\n        }\n        CarouselTemplate.render(slides, this.options)\n        // if (firstSlide) {\n        //   CarouselTemplate.goTo(firstSlide, this.options);\n        // }\n\n        // Set state\n        this.cycling = true\n\n        return Promise.resolve(true)\n      })\n      .catch(_ => {\n        console.error('could not start the carousel')\n        return Promise.reject(false)\n      })\n  }\n\n  /**\n   * Hide the carousel\n   */\n  stop() {\n    // Set state\n    this.cycling = false\n    // Stop\n    CarouselTemplate.stop(this.options)\n  }\n\n  /**\n   * Restart the carousel if it was stopped\n   */\n  private restart(firstSlide?: number) {\n    // Set state\n    this.cycling = true\n    // Restart\n    CarouselTemplate.restart(this.options)\n    // if (firstSlide) {\n    //   CarouselTemplate.goTo(firstSlide, this.options);\n    // }\n  }\n}\n"],"names":["$"],"mappings":"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"}